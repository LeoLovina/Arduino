<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
    crossorigin="anonymous">

  <title>IoT Arduino Control</title>
</head>

<body>
  <div class="container">
    <div class="jumbotron jumbotron-fluid">
      <div class="container">
        <h1 class="display-2">物聯網實作</h1>
        <p class="lead text-info">收集資料和傳送資料到雲端、輕鬆載入和分析該資訊，且提供管理裝置的能力！ 隨時可溝通。可靠地擴展。數兆則訊息。數十億個裝置。</p>
      </div>
    </div>
  </div>
  <div class="container">
    <!-- Relay 控制-->
    <div class="jumbotron">
      <h1>LED 燈控制</h1>
      <div class="btn-group btn-group-large" role="group" aria-label="Basic example">
        <button type="button" class="btn btn-success" id="openBtn">ON</button>
        <button type="button" class="btn btn-danger" id="closeBtn">OFF</button>
      </div>
    </div>
  </div>

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>
  <script src="https://www.gstatic.com/firebasejs/5.4.2/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyDcMu--bU5K9JVa7AMM_C910pCSDJgC0ys",
      authDomain: "arduino-ff0bc.firebaseapp.com",
      databaseURL: "https://arduino-ff0bc.firebaseio.com",
      projectId: "arduino-ff0bc",
      storageBucket: "arduino-ff0bc.appspot.com",
      messagingSenderId: "687040984573"
    };
    firebase.initializeApp(config);

    // Get a reference to the database service
    var database = firebase.database();

    $(document).ready(function () {
      console.log("ready!");
      var relayRef = database.ref('iot0901/relay');
      relayRef.on('value', function (snapshot) {
        var relayVal = snapshot.val();
        if (relayVal){
          $('#openBtn').removeClass('btn-success').addClass('btn-secondary');
          $('#closeBtn').removeClass('btn-secondary').addClass('btn-danger');
        }
        else {
          $('#openBtn').removeClass('btn-secondary').addClass('btn-success');
          $('#closeBtn').removeClass('btn-danger').addClass('btn-secondary');
        }
        console.log('relayVal : '+ relayVal);
      });

      $('#openBtn').click(function(){
        relayRef.set(true);
      });

      $('#closeBtn').click(function(){
        relayRef.set(false);
      });

      // $('#btnRealtime').click(onSetValue);
    });

    // function onTest() {
    //   alert('haha');
    //   writeUserData("A001", "Leo Chen", 'email@gmail.com', "imageUrl");
    // }
  </script>
</body>

</html>